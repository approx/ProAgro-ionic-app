<!--
  Generated template for the ActivityEditPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-content *ngIf="activity.crop" padding>
  <h1>Editar Atividade - {{activity.crop.field.name}} - {{activity.crop.name}}</h1>
  <form (ngSubmit)="Update()" #RegisterForm="ngForm">
    <ion-grid padding class="formContent">
      <ion-row style="align-items: flex-end;">
        <ion-col col-12 col-md-4 col-lg-4>
          <input type="hidden" required name="activityType" [(ngModel)]="activity_type" [value]="activity_type">
          <ion-item>
            <select-searchable
                name="atividade"
                title="Atividade*"
                [(ngModel)]="activityTypeSelect"
                [items]="activityTypes"
                [canReset]="true"
                itemValueField="id"
                itemTextField="name"
                [canSearch]="true"
                (onChange)="portChange($event)"
                (onSearch)="searchActivities($event)">
                <ng-template selectSearchableLabelTemplate>
                  Atividade*
                </ng-template>
                <ng-template selectSearchableItemTemplate let-port="item">
                  {{port.group.name}} - {{port.name}}
                </ng-template>
            </select-searchable>
          </ion-item>
        </ion-col>
        <ion-col col-12 col-md-4 col-lg-4>
          <ion-item>
            <ion-label floating>Nome</ion-label>
            <ion-input type="text" [(ngModel)]="activity.product_name" name="product_name" ></ion-input>
          </ion-item>
        </ion-col>
        <ion-col col-12 col-md-4>
          <ion-item padding-top>
            <ion-label floating>Unidade</ion-label>
            <ion-select [(ngModel)]="activity.unity_id" name="unity">
              <ion-option *ngFor="let unity of unities" value="{{unity.id}}">{{unity.id}} - {{unity.name}}</ion-option>
            </ion-select>
          </ion-item>
        </ion-col>
        <ion-col col-12 col-md-4>
          <ion-item>
            <ion-label floating>Valor unitário</ion-label>
            <ion-input  type="text" (ionChange)="calculateTotal()" [(modelMask)]="activity.unity_value" [mask]="activity.crop.field.farm.currency_id=='BRL' ? 'R$ 9':'$ 9'" [form]="RegisterForm" currency="true" name="unity_value" ></ion-input>
          </ion-item>
        </ion-col>
        <ion-col col-12 col-md-4>
          <ion-item>
            <ion-label floating>Dose</ion-label>
            <ion-input type="text" (ionChange)="calculateTotal()" [(modelMask)]="activity.dose" name="dose" [mask]="'9'" currency="true"></ion-input>
          </ion-item>
        </ion-col>
        <ion-col col-12 col-md-4>
          <ion-item>
            <ion-label floating>Quantidade</ion-label>
            <ion-input type="text" [(modelMask)]="activity.quantity" name="quantity" [mask]="'9'" currency="true"></ion-input>
          </ion-item>
        </ion-col>
        <ion-col col-12 col-md-4 >
          <ion-item>
            <ion-label floating>Data da operação*</ion-label>
            <ion-input type="text" required [(modelMask)]="activity.operation_date" [form]="RegisterForm" [clean]="false" mask="99/99/9999" maskPlaceHolder="_" name="operation_date"></ion-input>
          </ion-item>
        </ion-col>
        <ion-col col-12 col-md-4>
          <ion-item>
            <ion-label floating>Data do pagamento*</ion-label>
            <ion-input  required [(modelMask)]="activity.payment_date" [form]="RegisterForm" [clean]="false" mask="99/99/9999" maskPlaceHolder="_" name="payment_date"></ion-input>
          </ion-item>
        </ion-col>
        <ion-col col-12 col-md-4>
          <ion-item>
            <ion-label floating>Valor total*</ion-label>
            <ion-input type="text" [(modelMask)]="activity.total_value" [mask]="activity.crop.field.farm.currency_id=='BRL' ? 'R$ 9':'$ 9'" [form]="RegisterForm" currency="true" name="total_value" ></ion-input>
          </ion-item>
        </ion-col>
      </ion-row>
      <ion-row margin-top class="justifyCenter" margin-bottom>
        <button type="submit" [disabled]="!RegisterForm.form.valid" ion-button col-12 col-md-3>Salvar Alterações</button>
        <button type="button" ion-button col-12 col-md-3 (click)="back()">Voltar</button>
      </ion-row>
    </ion-grid>
  </form>

</ion-content>
